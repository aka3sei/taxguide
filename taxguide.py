import streamlit as st

# ページ設定
st.set_page_config(page_title="不動産税金・完全攻略ガイド", layout="wide")

st.title("⚖️ 不動産税金マスター・プロフェッショナルガイド")
st.write("複雑な税率をフェーズごとに整理。実務で役立つ正確な知識を網羅。")

# タブでフェーズを分ける
tab1, tab2, tab3 = st.tabs(["🆕 取得時の税金", "🏠 所有時の税金", "💰 売却時の税金"])

# ==========================================
# 🆕 1. 取得時の税金
# ==========================================
with tab1:
    st.header("1. 物件を購入したときにかかる税金")
    
    col1, col2 = st.columns(2)
    
    with col1:
        st.subheader("🖋️ 印紙税（売買契約書）")
        st.markdown("""
        契約金額によって異なります（令和6年3月31日までの軽減税率適用）。
        - 1,000万円超 〜 5,000万円以下：**1万円**
        - 5,000万円超 〜 1億円以下：**3万円**
        - 1億円超 〜 5億円以下：**6万円**
        """)
        
        st.subheader("📜 登録免許税")
        st.markdown("""
        登記にかかる税金。軽減措置適用後の税率：
        - **土地（所有権移転）**: 1.5%
        - **建物（新築・所有権保存）**: 0.15%
        - **建物（中古・所有権移転）**: 0.3%
        - **抵当権設定（ローン利用）**: 0.1%
        """)

    with col2:
        st.subheader("🏗️ 不動産取得税")
        st.markdown("""
        購入後に1回だけかかる地方税。
        - **土地・住宅**: 固定資産税評価額 × **3%**
        - **非住宅（店舗等）**: 固定資産税評価額 × **4%**
        
        **💡 軽減措置**: 
        床面積50㎡〜240㎡以下の住宅の場合、評価額から最大1,200万円（新築）が控除されます。
        """)

# ==========================================
# 🏠 2. 所有時の税金
# ==========================================
with tab2:
    st.header("2. 物件を所有している間にかかる税金")
    
    col_a, col_b = st.columns(2)
    
    with col_a:
        st.subheader("📅 固定資産税（毎年）")
        st.markdown("""
        毎年1月1日時点の所有者に課税されます。
        - **標準税率**: 評価額 × **1.4%**
        
        **【小規模住宅地の特例】**
        200㎡以下の部分は、課税標準額が **1/6** に軽減されます。
        """)

    with col_b:
        st.subheader("🏙️ 都市計画税（毎年）")
        st.markdown("""
        市街化区域内の物件にかかります。
        - **制限税率（上限）**: 評価額 × **0.3%**
        
        **【小規模住宅地の特例】**
        200㎡以下の部分は、課税標準額が **1/3** に軽減されます。
        """)

# ==========================================
# 💰 3. 売却時の税金
# ==========================================
with tab3:
    st.header("3. 物件を売却したとき（譲渡所得税）")
    st.warning("所有期間によって税率が倍近く変わるため、注意が必要です。")
    
    # 計算シミュレーションの簡易UI
    price = st.number_input("売却利益（譲渡益）を入力してください (単位:万円)", value=1000)
    
    st.markdown("### 所有期間による税率の違い")
    
    tax_col1, tax_col2 = st.columns(2)
    
    with tax_col1:
        st.error("📉 短期譲渡所得（5年以下）")
        st.markdown(f"""
        売却した年の1月1日時点で所有期間が5年以下のもの。
        - 税率：**39.63%** (所得税30% + 住民税9% + 復興0.63%)
        - 推定税額：**{price * 0.3963:.1f}万円**
        """)

    with tax_col2:
        st.success("📈 長期譲渡所得（5年超）")
        st.markdown(f"""
        売却した年の1月1日時点で所有期間が5年を超えるもの。
        - 税率：**20.315%** (所得税15% + 住民税5% + 復興0.315%)
        - 推定税額：**{price * 0.20315:.1f}万円**
        """)

    st.divider()
    st.subheader("💎 特別控除（プロの視点）")
    st.markdown("""
    - **居住用財産の3,000万円特別控除**: 自分が住んでいる家を売る場合、利益から最大3,000万円まで控除可能。
    - **10年超所有の軽減税率**: 10年超所有の居住用不動産は、6,000万円以下の部分について税率が **14.21%** まで下がります。
    """)

st.divider()
st.caption("※本アプリの税率は令和5年度現在のものです。実際の申告に際しては税理士や税務署にご確認ください。")